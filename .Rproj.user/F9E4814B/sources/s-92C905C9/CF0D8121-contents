---
title: "Sentence Reading Task Results (Andrés Rojas, 2022)"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```


```{r, include=FALSE}
library(here)
library(tidyverse)
library(kableExtra)

source(here("scripts", "05_load_data.R"))
```

## Overview

The purpose of this document is to provide a statistical analysis of the data of three participants segmented so far (Andrés Rojas, 2022). 
The primary research question investigated was whether there was a difference in rhotic production (both taps and trills) between a pre-test and post-test. 
The following analysis is for the 3 participants in the sentence reading task only. 
Overall, I took the following steps in the analysis:

1. I imported and tidyed the data. The scripts that I used is available in this github repo under `scripts/01_tidy_srt.R`. In addition to the script to tidy the data, I also wrote a function `run_t_test` to help run paired t-tests per participant that can be used later (and to more or less automate further analysis in this style). This function's source code can be found in this repo under `scripts/00_helpers.R`

2. I ran the scripts and analyzed the data to within this document, please see the results below:

## Results 

Overall, it looks like the training worked well for P3E, but not as much for the other two. 
Below 


```{r}
tap_df <- srt %>% 
  filter(!duration == "N/A" & !duration == "N/A /d/") %>% 
  group_by(participant, is_trill, time) %>% 
  filter(is_trill == "tap") %>% 
  summarize(mean = mean(as.numeric(duration))) %>% 
  pivot_wider(names_from = participant, values_from = mean) %>% 
  dplyr::select(time, P1E, P3E, P5E) %>% 
  arrange(desc(time)) 

tap_df$is_trill <- NULL

tap_df %>% 
  knitr::kable(digits = 2, caption = "Table 1: Average duration of tap productions during pre and post-tests per participant") %>% 
  kable_styling(full_width = FALSE)


```



```{r}

trill_df <- srt %>% 
  filter(!duration == "N/A" & !duration == "N/A /d/") %>% 
  group_by(participant, is_trill, time) %>% 
  filter(is_trill == "trill") %>% 
  summarize(mean = mean(as.numeric(duration))) %>% 
  pivot_wider(names_from = participant, values_from = mean) %>%
  dplyr::select(time, P1E, P3E, P5E) %>% 
  arrange(desc(time))

trill_df$is_trill <- NULL

trill_df %>% 
  knitr::kable(digits = 2, caption = "Table 2: Average duration of trill productions during pre and post-tests per participant") %>% 
  kable_styling(full_width = FALSE)

```



```{r}
srt_t_test <- read.csv(here("data", "tidy", "srt_t_tests.csv")) 
```


```{r}
srt_t_test %>%
  filter(tap_or_trill == "tap") %>% 
  select(Participant, p_val, t_val, estimate, ci_lo, ci_hi) %>% 
  knitr::kable(digits = 3, caption = "
Table 3: Results of Paired t-tests of taps comparing duration during pre and post tests") %>% 
  kable_styling(full_width = FALSE)

```



```{r}
srt_t_test %>%
  filter(tap_or_trill == "trill") %>% 
  select(Participant, p_val, t_val, estimate, ci_lo, ci_hi) %>% 
  knitr::kable(digits = 3, caption = "Table 4: Results of Paired t-tests of trills comparing duration during pre and post tests") %>% 
  kable_styling(full_width = FALSE)

```


**Figure 1: Productions of taps per participant during the pre and post test**
```{r, dpi = 300}

level_order <- c('PRE', 'POST')

srt %>% 
  filter(!duration == "N/A" & !duration == "N/A /d/") %>%
  filter(is_trill == "tap") %>% 
  ggplot(aes(x = factor(time, level = level_order), y = as.numeric(duration), color = is_trill)) + geom_boxplot(fill = "deepskyblue4", color = "black", outlier.size = 0) + 
  facet_wrap(~participant) + xlab("Test Time") + ylab("Rhotic Duration (ms)") +
  theme_bw() +
  theme(panel.background = element_rect(fill = "grey79"),
        legend.position = "bottom") + theme(legend.position = "none")  + ggtitle("Taps")
```



**Figure 2: Productions of trills per participant during the pre and post test**
```{r, dpi = 300}


level_order <- c('PRE', 'POST')

srt %>% 
  filter(!duration == "N/A" & !duration == "N/A /d/") %>%
  filter(is_trill == "trill") %>% 
  ggplot(aes(x = factor(time, level = level_order), y = as.numeric(duration), color = is_trill)) + geom_boxplot(fill = "deepskyblue4", color = "black", outlier.size = 0) + 
  facet_wrap(~participant) + xlab("Test Time") + ylab("Rhotic Duration (ms)") +
  theme_bw() +
  theme(panel.background = element_rect(fill = "grey79"),
        legend.position = "bottom") + theme(legend.position = "none") + ggtitle("Trills")
```


