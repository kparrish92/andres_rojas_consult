mutate("color" =
case_when(re_adjusted > 0 ~ 1,
re_adjusted < 0 ~ 0))
View(ranef_df_1)
model = pct_tap_cat
effect = "timePOST"
fixef_df = fixef(model) %>%
as.data.frame() %>%
t() %>%
as.data.frame()
fixef = fixef_df$timePOST
fixef_2 = fixef_df$timePOST
fixef_3 = fixef_df$timePOST
group_101 = c("sp1_P1E", "sp1_P3E", "sp1_P5E", "sp1_P6E", "sp1_P7E",
"sp1_P8E")
group_102 = c("sp102_P1E", "sp102_P2E", "sp102_P3E")
group_203 = c("sp203_P1E", "sp203_P2E", "sp203_P3E", "sp204_P2E")
ranef_df_1 = brms::ranef(model) %>%
as.data.frame() %>%
filter(term == effect) %>%
filter(grp %in% group_101) %>%
mutate(re_adjusted = as.numeric(fixef) + as.numeric(condval)) %>%
mutate(re_hi = re_adjusted + condsd) %>%
mutate(re_lo = re_adjusted - condsd) %>%
mutate("color" =
case_when(re_adjusted > 0 ~ 1,
re_adjusted < 0 ~ 0))
ranef_df_2 = brms::ranef(model) %>%
as.data.frame() %>%
filter(term == effect) %>%
filter(grp %in% group_102) %>%
mutate(re_adjusted = as.numeric(fixef_2) + as.numeric(condval)) %>%
mutate(re_hi = re_adjusted + condsd) %>%
mutate(re_lo = re_adjusted - condsd) %>%
mutate("color" =
case_when(re_adjusted > 0 ~ 1,
re_adjusted < 0 ~ 0))
ranef_df_3 = brms::ranef(model) %>%
as.data.frame() %>%
filter(term == effect) %>%
filter(grp %in% group_203) %>%
mutate(re_adjusted = as.numeric(fixef_3) + as.numeric(condval)) %>%
mutate(re_hi = re_adjusted + condsd) %>%
mutate(re_lo = re_adjusted - condsd) %>%
mutate("color" =
case_when(re_adjusted > 0 ~ 1,
re_adjusted < 0 ~ 0))
ranef_df = rbind(ranef_df_1, ranef_df_2, ranef_df_3)
ranef_df$grp <- factor(ranef_df$grp,
levels =
c("sp1_P1E",
"sp1_P3E",
"sp1_P5E",
"sp1_P6E",
"sp1_P7E",
"sp1_P8E",
"sp102_P1E",
"sp102_P2E",
"sp102_P3E",
"sp203_P1E",
"sp203_P2E",
"sp203_P3E",
"sp204_P2E"
))
plot = ranef_df %>%
ggplot(aes(y = grp, x = re_adjusted, fill = as.factor(color))) +
scale_fill_manual(values=c("#fa6652", "#0dbaff")) +
geom_pointrange(aes(xmin = re_hi, xmax = re_lo), size = .4, shape = 21) + geom_vline(xintercept = 0, linetype = "dashed") +
ylab("Participant ID") + xlab("Effect per participant") +
xlim(-100, 100) +
theme(text=element_text(size=10, family="Times")) +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major = element_line(
size = 0.1,
linetype = 'solid',
colour = "grey"),
legend.position = "none") + geom_text(data = mutate_if(ranef_df, is.numeric, round, 2),
aes(label = paste(re_adjusted, "[",
re_lo, "-", re_hi,
"]"), x = Inf),
hjust = "inward", family = "Times", size = 3) +
labs(title = paste(task, paste(taps)),
subtitle = "Difference between PRE and POST Test",
caption = paste(continuous))
model = pct_tap_cat
effect = "timePOST"
task = "Picture Naming Task"
taps = "Taps"
continuous = "Categorical"
model = pct_tap_cat
effect = "timePOST"
task = "Picture Naming Task"
taps = "Taps"
continuous = "Categorical"
fixef_df = fixef(model) %>%
as.data.frame() %>%
t() %>%
as.data.frame()
fixef = fixef_df$timePOST
fixef_2 = fixef_df$timePOST
fixef_3 = fixef_df$timePOST
group_101 = c("sp1_P1E", "sp1_P3E", "sp1_P5E", "sp1_P6E", "sp1_P7E",
"sp1_P8E")
group_102 = c("sp102_P1E", "sp102_P2E", "sp102_P3E")
group_203 = c("sp203_P1E", "sp203_P2E", "sp203_P3E", "sp204_P2E")
ranef_df_1 = brms::ranef(model) %>%
as.data.frame() %>%
filter(term == effect) %>%
filter(grp %in% group_101) %>%
mutate(re_adjusted = as.numeric(fixef) + as.numeric(condval)) %>%
mutate(re_hi = re_adjusted + condsd) %>%
mutate(re_lo = re_adjusted - condsd) %>%
mutate("color" =
case_when(re_adjusted > 0 ~ 1,
re_adjusted < 0 ~ 0))
ranef_df_2 = brms::ranef(model) %>%
as.data.frame() %>%
filter(term == effect) %>%
filter(grp %in% group_102) %>%
mutate(re_adjusted = as.numeric(fixef_2) + as.numeric(condval)) %>%
mutate(re_hi = re_adjusted + condsd) %>%
mutate(re_lo = re_adjusted - condsd) %>%
mutate("color" =
case_when(re_adjusted > 0 ~ 1,
re_adjusted < 0 ~ 0))
ranef_df_3 = brms::ranef(model) %>%
as.data.frame() %>%
filter(term == effect) %>%
filter(grp %in% group_203) %>%
mutate(re_adjusted = as.numeric(fixef_3) + as.numeric(condval)) %>%
mutate(re_hi = re_adjusted + condsd) %>%
mutate(re_lo = re_adjusted - condsd) %>%
mutate("color" =
case_when(re_adjusted > 0 ~ 1,
re_adjusted < 0 ~ 0))
ranef_df = rbind(ranef_df_1, ranef_df_2, ranef_df_3)
ranef_df$grp <- factor(ranef_df$grp,
levels =
c("sp1_P1E",
"sp1_P3E",
"sp1_P5E",
"sp1_P6E",
"sp1_P7E",
"sp1_P8E",
"sp102_P1E",
"sp102_P2E",
"sp102_P3E",
"sp203_P1E",
"sp203_P2E",
"sp203_P3E",
"sp204_P2E"
))
plot = ranef_df %>%
ggplot(aes(y = grp, x = re_adjusted, fill = as.factor(color))) +
scale_fill_manual(values=c("#fa6652", "#0dbaff")) +
geom_pointrange(aes(xmin = re_hi, xmax = re_lo), size = .4, shape = 21) + geom_vline(xintercept = 0, linetype = "dashed") +
ylab("Participant ID") + xlab("Effect per participant") +
xlim(-100, 100) +
theme(text=element_text(size=10, family="Times")) +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major = element_line(
size = 0.1,
linetype = 'solid',
colour = "grey"),
legend.position = "none") + geom_text(data = mutate_if(ranef_df, is.numeric, round, 2),
aes(label = paste(re_adjusted, "[",
re_lo, "-", re_hi,
"]"), x = Inf),
hjust = "inward", family = "Times", size = 3) +
labs(title = paste(task, paste(taps)),
subtitle = "Difference between PRE and POST Test",
caption = paste(continuous))
plot
model = pct_tap_cat
effect = "timePOST"
task = "Picture Naming Task"
taps = "Taps"
continuous = "Categorical"
fixef_df = fixef(model) %>%
as.data.frame() %>%
t() %>%
as.data.frame()
fixef = fixef_df$timePOST
fixef_2 = fixef_df$timePOST
fixef_3 = fixef_df$timePOST
group_101 = c("sp1_P1E", "sp1_P3E", "sp1_P5E", "sp1_P6E", "sp1_P7E",
"sp1_P8E")
group_102 = c("sp102_P1E", "sp102_P2E", "sp102_P3E")
group_203 = c("sp203_P1E", "sp203_P2E", "sp203_P3E", "sp204_P2E")
ranef_df_1 = brms::ranef(model) %>%
as.data.frame() %>%
filter(term == effect) %>%
filter(grp %in% group_101) %>%
mutate(re_adjusted = as.numeric(fixef) + as.numeric(condval)) %>%
mutate(re_hi = re_adjusted + condsd) %>%
mutate(re_lo = re_adjusted - condsd) %>%
mutate("color" =
case_when(re_adjusted > 0 ~ 1,
re_adjusted < 0 ~ 0))
ranef_df_2 = brms::ranef(model) %>%
as.data.frame() %>%
filter(term == effect) %>%
filter(grp %in% group_102) %>%
mutate(re_adjusted = as.numeric(fixef_2) + as.numeric(condval)) %>%
mutate(re_hi = re_adjusted + condsd) %>%
mutate(re_lo = re_adjusted - condsd) %>%
mutate("color" =
case_when(re_adjusted > 0 ~ 1,
re_adjusted < 0 ~ 0))
ranef_df_3 = brms::ranef(model) %>%
as.data.frame() %>%
filter(term == effect) %>%
filter(grp %in% group_203) %>%
mutate(re_adjusted = as.numeric(fixef_3) + as.numeric(condval)) %>%
mutate(re_hi = re_adjusted + condsd) %>%
mutate(re_lo = re_adjusted - condsd) %>%
mutate("color" =
case_when(re_adjusted > 0 ~ 1,
re_adjusted < 0 ~ 0))
ranef_df = rbind(ranef_df_1, ranef_df_2, ranef_df_3)
ranef_df$grp <- factor(ranef_df$grp,
levels =
c("sp1_P1E",
"sp1_P3E",
"sp1_P5E",
"sp1_P6E",
"sp1_P7E",
"sp1_P8E",
"sp102_P1E",
"sp102_P2E",
"sp102_P3E",
"sp203_P1E",
"sp203_P2E",
"sp203_P3E",
"sp204_P2E"
))
plot = ranef_df %>%
ggplot(aes(y = grp, x = re_adjusted, fill = as.factor(color))) +
scale_fill_manual(values=c("#fa6652", "#0dbaff")) +
geom_pointrange(aes(xmin = re_hi, xmax = re_lo), size = .4, shape = 21) + geom_vline(xintercept = 0, linetype = "dashed") +
ylab("Participant ID") + xlab("Effect per participant") +
xlim(-4, 4) +
theme(text=element_text(size=10, family="Times")) +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major = element_line(
size = 0.1,
linetype = 'solid',
colour = "grey"),
legend.position = "none") + geom_text(data = mutate_if(ranef_df, is.numeric, round, 2),
aes(label = paste(re_adjusted, "[",
re_lo, "-", re_hi,
"]"), x = Inf),
hjust = "inward", family = "Times", size = 3) +
labs(title = paste(task, paste(taps)),
subtitle = "Difference between PRE and POST Test",
caption = paste(continuous))
plot
model = pct_tap_cat
effect = "timePOST"
task = "Picture Naming Task"
taps = "Taps"
continuous = "Categorical"
fixef_df = fixef(model) %>%
as.data.frame() %>%
t() %>%
as.data.frame()
fixef = fixef_df$timePOST
fixef_2 = fixef_df$timePOST
fixef_3 = fixef_df$timePOST
group_101 = c("sp1_P1E", "sp1_P3E", "sp1_P5E", "sp1_P6E", "sp1_P7E",
"sp1_P8E")
group_102 = c("sp102_P1E", "sp102_P2E", "sp102_P3E")
group_203 = c("sp203_P1E", "sp203_P2E", "sp203_P3E", "sp204_P2E")
ranef_df_1 = brms::ranef(model) %>%
as.data.frame() %>%
filter(term == effect) %>%
filter(grp %in% group_101) %>%
mutate(re_adjusted = as.numeric(fixef) + as.numeric(condval)) %>%
mutate(re_hi = re_adjusted + condsd) %>%
mutate(re_lo = re_adjusted - condsd) %>%
mutate("color" =
case_when(re_adjusted > 0 ~ 1,
re_adjusted < 0 ~ 0))
ranef_df_2 = brms::ranef(model) %>%
as.data.frame() %>%
filter(term == effect) %>%
filter(grp %in% group_102) %>%
mutate(re_adjusted = as.numeric(fixef_2) + as.numeric(condval)) %>%
mutate(re_hi = re_adjusted + condsd) %>%
mutate(re_lo = re_adjusted - condsd) %>%
mutate("color" =
case_when(re_adjusted > 0 ~ 1,
re_adjusted < 0 ~ 0))
ranef_df_3 = brms::ranef(model) %>%
as.data.frame() %>%
filter(term == effect) %>%
filter(grp %in% group_203) %>%
mutate(re_adjusted = as.numeric(fixef_3) + as.numeric(condval)) %>%
mutate(re_hi = re_adjusted + condsd) %>%
mutate(re_lo = re_adjusted - condsd) %>%
mutate("color" =
case_when(re_adjusted > 0 ~ 1,
re_adjusted < 0 ~ 0))
ranef_df = rbind(ranef_df_1, ranef_df_2, ranef_df_3)
ranef_df$grp <- factor(ranef_df$grp,
levels =
c("sp1_P1E",
"sp1_P3E",
"sp1_P5E",
"sp1_P6E",
"sp1_P7E",
"sp1_P8E",
"sp102_P1E",
"sp102_P2E",
"sp102_P3E",
"sp203_P1E",
"sp203_P2E",
"sp203_P3E",
"sp204_P2E"
))
plot = ranef_df %>%
ggplot(aes(y = grp, x = re_adjusted, fill = as.factor(color))) +
scale_fill_manual(values=c("#fa6652", "#0dbaff")) +
geom_pointrange(aes(xmin = re_hi, xmax = re_lo), size = .4, shape = 21) + geom_vline(xintercept = 0, linetype = "dashed") +
ylab("Participant ID") + xlab("Effect per participant") +
xlim(-5, 1) +
theme(text=element_text(size=10, family="Times")) +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major = element_line(
size = 0.1,
linetype = 'solid',
colour = "grey"),
legend.position = "none") + geom_text(data = mutate_if(ranef_df, is.numeric, round, 2),
aes(label = paste(re_adjusted, "[",
re_lo, "-", re_hi,
"]"), x = Inf),
hjust = "inward", family = "Times", size = 3) +
labs(title = paste(task, paste(taps)),
subtitle = "Difference between PRE and POST Test",
caption = paste(continuous))
plot
plot_re_2 = function(model, effect, task, taps, continuous)
{
fixef_df = fixef(model) %>%
as.data.frame() %>%
t() %>%
as.data.frame()
fixef = fixef_df$timePOST
fixef_2 = fixef_df$timePOST
fixef_3 = fixef_df$timePOST
group_101 = c("sp1_P1E", "sp1_P3E", "sp1_P5E", "sp1_P6E", "sp1_P7E",
"sp1_P8E")
group_102 = c("sp102_P1E", "sp102_P2E", "sp102_P3E")
group_203 = c("sp203_P1E", "sp203_P2E", "sp203_P3E", "sp204_P2E")
ranef_df_1 = brms::ranef(model) %>%
as.data.frame() %>%
filter(term == effect) %>%
filter(grp %in% group_101) %>%
mutate(re_adjusted = as.numeric(fixef) + as.numeric(condval)) %>%
mutate(re_hi = re_adjusted + condsd) %>%
mutate(re_lo = re_adjusted - condsd) %>%
mutate("color" =
case_when(re_adjusted > 0 ~ 1,
re_adjusted < 0 ~ 0))
ranef_df_2 = brms::ranef(model) %>%
as.data.frame() %>%
filter(term == effect) %>%
filter(grp %in% group_102) %>%
mutate(re_adjusted = as.numeric(fixef_2) + as.numeric(condval)) %>%
mutate(re_hi = re_adjusted + condsd) %>%
mutate(re_lo = re_adjusted - condsd) %>%
mutate("color" =
case_when(re_adjusted > 0 ~ 1,
re_adjusted < 0 ~ 0))
ranef_df_3 = brms::ranef(model) %>%
as.data.frame() %>%
filter(term == effect) %>%
filter(grp %in% group_203) %>%
mutate(re_adjusted = as.numeric(fixef_3) + as.numeric(condval)) %>%
mutate(re_hi = re_adjusted + condsd) %>%
mutate(re_lo = re_adjusted - condsd) %>%
mutate("color" =
case_when(re_adjusted > 0 ~ 1,
re_adjusted < 0 ~ 0))
ranef_df = rbind(ranef_df_1, ranef_df_2, ranef_df_3)
ranef_df$grp <- factor(ranef_df$grp,
levels =
c("sp1_P1E",
"sp1_P3E",
"sp1_P5E",
"sp1_P6E",
"sp1_P7E",
"sp1_P8E",
"sp102_P1E",
"sp102_P2E",
"sp102_P3E",
"sp203_P1E",
"sp203_P2E",
"sp203_P3E",
"sp204_P2E"
))
plot = ranef_df %>%
ggplot(aes(y = grp, x = re_adjusted, fill = as.factor(color))) +
scale_fill_manual(values=c("#fa6652", "#0dbaff")) +
geom_pointrange(aes(xmin = re_hi, xmax = re_lo), size = .4, shape = 21) + geom_vline(xintercept = 0, linetype = "dashed") +
ylab("Participant ID") + xlab("Effect per participant") +
xlim(-5, 1) +
theme(text=element_text(size=10, family="Times")) +
theme(panel.background = element_rect(fill = "white"),
panel.grid.major = element_line(
size = 0.1,
linetype = 'solid',
colour = "grey"),
legend.position = "none") + geom_text(data = mutate_if(ranef_df, is.numeric, round, 2),
aes(label = paste(re_adjusted, "[",
re_lo, "-", re_hi,
"]"), x = Inf),
hjust = "inward", family = "Times", size = 3) +
labs(title = paste(task, paste(taps)),
subtitle = "Difference between PRE and POST Test",
caption = paste(continuous))
return(plot)
}
plot_re_2(model = pct_tap_cat, effect = "timePOST", task = "Picture Naming Task", taps = "Taps", continuous = "Categorical")
plot_re_2(model = pct_tap_cat, effect = "timePOST", task = "Picture Naming Task", taps = "Taps", continuous = "Categorical")
image_df_tidy_tap = image_df %>%
filter(is_trill == "tap") %>%
filter(no_occlusions == 1 | no_occlusions == "a") %>%
mutate(no_occlusions = replace(no_occlusions, no_occlusions == "a",
"approximate"))
pct_tidy_tap = image_df %>%
filter(is_trill == "tap") %>%
filter(no_occlusions == "a" | no_occlusions == 1)  %>%
mutate(no_occlusions = replace(no_occlusions, no_occlusions == "a", "approximate"))
pct_tidy_tap %>%
group_by(level, time, no_occlusions) %>%
summarize(mean_duration = n()) %>%
pivot_wider(names_from = time, values_from = mean_duration) %>%
select(level, no_occlusions, PRE, POST) %>%
knitr::kable()
lectura_tidy_tap = lectura %>%
filter(is_trill == "tap") %>%
filter(no_occlusions == "a" | no_occlusions == 1)  %>%
mutate(no_occlusions = replace(no_occlusions, no_occlusions == "a",
"approximate"))
lectura_tidy_tap %>%
group_by(level, time, no_occlusions) %>%
summarize(mean_duration = n()) %>%
pivot_wider(names_from = time, values_from = mean_duration) %>%
select(level, no_occlusions, PRE, POST) %>%
knitr::kable()
srt_tidy_tap = srt %>%
filter(is_trill == "tap") %>%
filter(no_occlusions == "a" | no_occlusions == 1)  %>%
mutate(no_occlusions = replace(no_occlusions, no_occlusions == "a",
"approximate"))
srt_tidy_tap %>%
group_by(level, time, no_occlusions) %>%
summarize(mean_duration = n()) %>%
pivot_wider(names_from = time, values_from = mean_duration) %>%
select(level, no_occlusions, PRE, POST) %>%
knitr::kable()
srt_tidy_tap = srt %>%
filter(is_trill == "tap") %>%
filter(no_occlusions == "a" | no_occlusions == 1)  %>%
mutate(no_occlusions = replace(no_occlusions, no_occlusions == "a",
"approximate"))
srt_tidy_tap %>%
group_by(level, time, no_occlusions) %>%
summarize(mean_duration = n()) %>%
pivot_wider(names_from = time, values_from = mean_duration) %>%
rename(no_occlusions = "Occlusion Type") %>%
select(level, no_occlusions, PRE, POST) %>%
knitr::kable()
srt_tidy_tap = srt %>%
filter(is_trill == "tap") %>%
filter(no_occlusions == "a" | no_occlusions == 1)  %>%
mutate(no_occlusions = replace(no_occlusions, no_occlusions == "a",
"approximate"))
srt_tidy_tap %>%
group_by(level, time, no_occlusions) %>%
summarize(mean_duration = n()) %>%
pivot_wider(names_from = time, values_from = mean_duration) %>%
select(level, no_occlusions, PRE, POST) %>%
knitr::kable()
srt_tidy_tap = srt %>%
filter(is_trill == "tap") %>%
filter(no_occlusions == "a" | no_occlusions == 1)  %>%
mutate(no_occlusions = replace(no_occlusions, no_occlusions == "a",
"approximate"))
srt_tidy_tap %>%
group_by(no_occlusions, time) %>%
summarize(n = n())
srt_tidy_tap %>%
group_by(no_occlusions, time) %>%
summarize(n = n())
srt_tidy_tap_all = srt %>%
filter(is_trill == "tap")
srt_tidy_tap_all %>%
group_by(no_occlusions, time) %>%
summarize(n = n())
tab_model(srt_tap_cat, dv.labels = "Probability of approximate realization")
plot_model(srt_tap_cat, title = "Probability of approximate realization") + theme(text=element_text(size=10, family="Times"))
plot_re(model = srt_tap_cat, effect = "timePOST", task = "Sentence Reading Task", taps = "Taps", continuous = "Categorical") + xlim(-7,7)
plot_re(model = srt_tap_cat, effect = "timePOST", task = "Sentence Reading Task", taps = "Taps", continuous = "Categorical") + xlim(-7,7)
plot_re_2(model = pct_tap_cat, effect = "timePOST", task = "Picture Naming Task", taps = "Taps", continuous = "Categorical")
plot_model(lectura_tap_cat, title = "Probability of approximate realization") + theme(text=element_text(size=10, family="Times"))
plot_model(pct_tap_cat, title = "Probability of approximate realization") + theme(text=element_text(size=10, family="Times")) + xlim(-2, 2)
plot_model(pct_tap_cat, title = "Probability of approximate realization") + theme(text=element_text(size=10, family="Times")) + xlim(-2, 2)
View(srt_trill_mod)
View(srt_tidy_trill)
View(srt_trill_mod)
